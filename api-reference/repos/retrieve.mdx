---
title: 'Retrieve'
api: 'POST https://api.relace.run/v1/repo/{repo_id}/retrieve'
description: 'Two-stage codebase retrieval using semantic search'
---

<Note>
  The retrieve endpoint provides advanced semantic search capabilities with additional parameters for fine-tuning results. For complete parameter documentation, see below.
</Note>

## Path Parameters

<ParamField path="repo_id" type="string" required>
  Repo ID
</ParamField>

## Request Body

<ParamField body="query" type="string" required>
  Natural language description of what you're looking for
</ParamField>

<ParamField body="score_threshold" type="number" default="0.3">
  Minimum relevance score for results (0.0 to 1.0)
</ParamField>

<ParamField body="token_limit" type="integer" default="30000">
  Maximum number of tokens to return across all results
</ParamField>

<ParamField body="include_content" type="boolean" default="false">
  Whether to include file content in the response. If false, only filenames and scores are returned.
</ParamField>

## Response

<ResponseField name="results" type="array">
  Array of relevant files and code sections
  
  <Expandable title="properties" defaultOpen={false}>
    <ResponseField name="filename" type="string">
      Path to the file within the repo
    </ResponseField>

    <ResponseField name="score" type="number">
      Relevance score between 0.0 and 1.0
    </ResponseField>

    <ResponseField name="content" type="string">
      File content (only included when include_content=true)
    </ResponseField>
  </Expandable>
</ResponseField>


<RequestExample>

```bash cURL
curl -X POST https://api.relace.run/v1/repo/123e4567-e89b-12d3-a456-426614174000/retrieve \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "query": "authentication and user login functionality",
    "score_threshold": 0.3,
    "token_limit": 30000,
    "include_content": true
  }'
```

```python Python
import requests

repo_id = "123e4567-e89b-12d3-a456-426614174000"
url = f"https://api.relace.run/v1/repo/{repo_id}/retrieve"
headers = {
    "Authorization": "Bearer YOUR_API_KEY",
    "Content-Type": "application/json"
}
data = {
    "query": "authentication and user login functionality",
    "score_threshold": 0.3,
    "token_limit": 30000,
    "include_content": True
}

response = requests.post(url, headers=headers, json=data)
print(response.json())
```

```ts TypeScript SDK
import createRelaceClient from '@relace-ai/agent-client'

const client = createRelaceClient({ apiKey: process.env.RELACE_API_KEY! })

const { data } = await client.POST('/repo/{repo_id}/retrieve', {
  params: { path: { repo_id: '123e4567-e89b-12d3-a456-426614174000' } },
  body: {
    query: 'authentication and user login functionality',
    score_threshold: 0.3,
    token_limit: 30000,
    include_content: true,
  },
})
console.log(data?.results?.map((r) => ({ file: r.filename, score: r.score })))
```

```python Python SDK
from relace_agent_client import AuthenticatedClient
from relace_agent_client.api.default import retrieve_relevant_content_repo_repo_id_retrieve_post
from relace_agent_client.models import RepoRetrieveRequest

client = AuthenticatedClient(base_url="https://api.relace.run/v1", token="YOUR_API_KEY")
with client as c:
    r = retrieve_relevant_content_repo_repo_id_retrieve_post.sync(
        client=c,
        repo_id="123e4567-e89b-12d3-a456-426614174000",
        body=RepoRetrieveRequest(query="authentication and user login functionality", include_content=True, score_threshold=0.3),
    )
print(r)
```

</RequestExample>

<ResponseExample>

```json Response
{
  "results": [
    {
      "filename": "src/auth.py",
      "content": "def authenticate_user(username, password):\n    \"\"\"Authenticate user credentials against the database.\"\"\"\n    user = User.query.filter_by(username=username).first()\n    if user and bcrypt.check_password_hash(user.password_hash, password):\n        return user\n    return None",
      "score": 0.94
    },
    {
      "filename": "src/models/user.py",
      "content": "class User(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    username = db.Column(db.String(80), unique=True, nullable=False)\n    password_hash = db.Column(db.String(128), nullable=False)",
      "score": 0.87
    }
  ]
}
```

</ResponseExample>
